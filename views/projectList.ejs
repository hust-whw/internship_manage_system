<!DOCTYPE html>
<html lang="en">

  <head>
  
    <!-- Basic -->
      <meta charset="UTF-8" />

    <title>项目列表</title>
   
    <!-- Mobile Metas -->
      <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
          
    <!-- Favicon and touch icons -->
    <link rel="shortcut icon" href="/assets/ico/favicon.ico" type="image/x-icon" />
    <link rel="apple-touch-icon" href="/assets/ico/apple-touch-icon.png" />
    <link rel="apple-touch-icon" sizes="57x57" href="/assets/ico/apple-touch-icon-57x57.png" />
    <link rel="apple-touch-icon" sizes="72x72" href="/assets/ico/apple-touch-icon-72x72.png" />
    <link rel="apple-touch-icon" sizes="76x76" href="/assets/ico/apple-touch-icon-76x76.png" />
    <link rel="apple-touch-icon" sizes="114x114" href="/assets/ico/apple-touch-icon-114x114.png" />
    <link rel="apple-touch-icon" sizes="120x120" href="/assets/ico/apple-touch-icon-120x120.png" />
    <link rel="apple-touch-icon" sizes="144x144" href="/assets/ico/apple-touch-icon-144x144.png" />
    <link rel="apple-touch-icon" sizes="152x152" href="/assets/ico/apple-touch-icon-152x152.png" />
    

    <link href="https://cdn.bootcss.com/select2/3.4.6/select2.min.css" rel="stylesheet">
    <link href="https://cdn.bootcss.com/datatables/1.10.15/css/jquery.dataTables.min.css" rel="stylesheet">
    <!-- <link href="/assets/plugins/select2/select2.css" rel="stylesheet" /> -->
    <!-- <link href="/assets/plugins/jquery-datatables-bs3/css/datatables.css" rel="stylesheet" />  -->
    <%- include('components/common-css') %>
    
  </head>
  
  <body>
  
    <!-- Start: Header -->
    <div class="navbar" role="navigation">
      <div class="container-fluid container-nav">
        <!-- Navbar Action -->
        <ul class="nav navbar-nav navbar-actions navbar-left">
          <li class="visible-md visible-lg"><a href="#" id="main-menu-toggle"><i class="fa fa-th-large"></i></a></li>
          <li class="visible-xs visible-sm"><a href="#" id="sidebar-menu"><i class="fa fa-navicon"></i></a></li>      
        </ul>
        <!-- Navbar Left -->
        
        <div class="navbar-left">
          <!-- Search Form -->          
          <!-- <form class="search navbar-form">
            <div class="input-group input-search">
              <input type="text" class="form-control bk-radius" name="q" id="q" placeholder="Search...">
              <span class="input-group-btn">
                <button class="btn btn-default" type="submit"><i class="fa fa-search"></i></button>
              </span>
            </div>            
          </form>    -->                              
        </div>

        
        <!-- Navbar Right -->
        <div class="navbar-right">          
          <%- include('components/notification') %>
        </div>
        <!-- End Navbar Right -->
      </div>    
    </div>
    <!-- End: Header -->
    
    
    <!-- Start: Content -->
    <div class="container-fluid content"> 
      <div class="row">
      
        <%- include('components/side-bar') %>
            
        <!-- Main Page -->
        <div class="main ">
          <!-- Page Header -->
          <div class="page-header">
            <div class="pull-left">
              <ol class="breadcrumb visible-sm visible-md visible-lg">                
                
                <li><i class="fa fa-laptop"></i>主页</li>
                <li class="active"><i class="fa fa-random"></i>项目列表</li>
              </ol>           
            </div>
            <div class="pull-right">
            
            </div>          
          </div>
          <!-- End Page Header -->
          
          <div class="row">
            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
              <div class="panel panel-default bk-bg-white">
                <div class="panel-heading bk-bg-white">
                  <h6><i class="fa fa-table red"></i><span class="break"></span>项目信息管理
  <a href="/project/add"><button type="button" class="bk-margin-5 btn btn-primary">+添加项目</button></a>
                  </h6>             
                  <div class="panel-actions">
                    <a href="#" class="btn-minimize"><i class="fa fa-caret-up"></i></a>
                    <a href="#" class="btn-close"><i class="fa fa-times"></i></a>
                  </div>
                </div>
                <div class="panel-body">
                
                    <!-- <div class="row">
                    <div class="col-sm-6">
                      <div class="bk-margin-bottom-10">
                        <button id="addToTable" class="btn btn-info">Add <i class="fa fa-plus"></i></button>
                      </div>
                    </div>
                  </div> -->
                  
                  <div class="table-responsive">
                    <table class="table table-bordered  table-condensed mb-none" id="datatable-default">
                      <thead>
                        <tr>
                          <!-- <th>项目ID</th> -->
                          <th>项目名称</th>
                          <th>指导老师</th>
                          <th>提交时间</th>
                          <th>是否归档</th>
                          <th>归档日期</th>
                         
                          <th><button type="button" class="fileall bk-margin-5 btn btn-success"><i class="fa fa-magic"></i> 归档所有项目</button></th>  
                          
                          <!--<th class="text-right">Low</th>
                          <th class="text-right">Volume</th>-->
                        </tr>
                      </thead>
                      <tbody>
                      <% project.forEach(function(x){ %>        
                        <tr <%= x.IsFiled?'style=background-color:pink':'' %>>
                          <!-- <td><%= x._id %></td> -->
                          <td><%= x.Name %></td>
                          <td><%= x.Author.Name %></td>
                          <td><%= x.PublishedDate %></td>
                          <td><%= x.IsFiled?'已归档':'未归档' %></td>
                          <td><%= x.IsFiled?x.FiledDate:'---'%></td>
                          <!-- <td><span class="label label-warning">Pending</span>0</td> -->
                          <td>
                            
                            <a data-id="<%= x._id %>" class="file btn btn-info"  title="归档本项目"  <%= x.IsFiled?'style=display:none':'' %>>
                                <i class="fa fa-edit "></i>  归档                                          
                            </a>
                            <a data-id="<%= x._id %>" class="disfile btn btn-danger" title="解除归档" <%= x.IsFiled?'':'style=display:none' %>>
                                <i class="fa fa-trash-o "></i> 解除归档

                            </a>
                            <a class="btn btn-success" href="table.html#" title="下载该项目" disabled="true" <%= x.IsFiled?'':'style=display:none' %>>
                                <i class="fa fa-search-plus "></i>  下载                                          
                            </a>
                          </td>
                        </tr>

                        <% }); %>
                      </tbody>
                    </table>
                  </div>
                </div>
              </div>              
              
            </div>            
            
            
          </div>
          

        </div>
        <!-- End Main Page -->
        
      
      </div>
    </div><!--/container-->
    
    
    <div class="clearfix"></div>    
    
    <%- include('components/common-js') %>
      
    <!-- <script src="/assets/plugins/select2/select2.js"></script>  -->
    <script src="https://cdn.bootcss.com/select2/3.4.6/select2.min.js"></script>   

    <!-- <script src="/assets/plugins/jquery-datatables/media/js/jquery.dataTables.js"></script> -->
    <script src="https://cdn.bootcss.com/datatables/1.10.15/js/jquery.dataTables.min.js"></script>

    <!-- <script src="/assets/plugins/jquery-datatables/extras/TableTools/js/dataTables.tableTools.min.js"></script> -->
    <script src="https://cdn.bootcss.com/datatables-tabletools/2.1.5/js/TableTools.min.js"></script>
    <script src="https://cdn.bootcss.com/datatables-tabletools/2.1.5/js/ZeroClipboard.min.js"></script>

    <script src="/assets/plugins/jquery-datatables-bs3/js/datatables.js"></script>    

    <script src="/assets/js/pages/table-advanced.js"></script>

    <script>

    $.extend( true, $.fn.dataTable.defaults, {
      "language": {
            "url": "//cdn.datatables.net/plug-ins/1.10.15/i18n/Chinese.json"
        },
    "searching": true,
    "ordering": false
    } );
 
 
  $(document).ready(function() {
      $('#datatable-default').DataTable();
  } );
      function getAll(){
         var tit = document.getElementById("selectAll");
         var inputs = document.getElementsByName("checkList");
         for(var i = 0; i < inputs.length; i++)
         {
          if(inputs[i].type == "checkbox")
          {
           if(tit.checked == true)
           {
          inputs[i].checked = true;
           }else{
          inputs[i].checked = false;
           }
          }
         }
      
      }

      $('.file').click(function(){

        var projectID = $(this).attr('data-id');
        $.ajax({ 
          url: '/project/file', 
          type: 'POST', 
          data: {
            projectID:projectID
          }, 

          success: function (returndata) { 
          
            location.reload() 

          }, 
          error: function (returndata) { 
            alert("提交失败！"); 
          } 
         });

      });


      $('.disfile').click(function(){

        var projectID = $(this).attr('data-id');
        $.ajax({ 
          url: '/project/disfile', 
          type: 'POST', 
          data: {
            projectID:projectID
          }, 

          success: function (returndata) { 
          
            location.reload()

          }, 
          error: function (returndata) { 
            alert("提交失败！"); 
          } 
         });

      });

      $('.fileall').click(function(){
        
        $.ajax({ 
          url: '/project/fileall', 
          type: 'POST', 
          data: {
          }, 

          success: function (returndata) { 
          
            location.reload()

          }, 
          error: function (returndata) { 
            alert("提交失败！"); 
          } 
         });

      });
      

    </script>
    
  </body>
  
</html>



